function Spec(t,e){var s=e.reporterOptions||{};s.screenshotDir=s.screenshotDir||defaults.screenshotDir,s.outputDir=s.outputDir||defaults.outputDir,s.storyDir=s.storyDir||defaults.storyDir;var r=null,i=t.suite.file,n=util.splitPath(i,s.storyDir,s.outputDir),a=_slicedToArray(n,2),o=a[0],u=a[1];s.console&&specReporter(t,e),s.screenshot&&t.on("fail",function(t){util.screenshot(t,s.screenshotDir)}),t.on("suite",function(t){r=new Suite(t,r),r.start()}),t.on("suite end",function(){r.stop(),r.parent&&(r.parent.addSuite(r),r=r.parent)}),t.on("pending",function(t){r.addTest(new Test(t,Test.TEST_PENDING))}),t.on("pass",function(t){r.addTest(new Test(t,Test.TEST_PASS))}),t.on("fail",function(t,e){r.addTest(new Test(t,Test.TEST_FAIL,e))}),t.on("end",function(){r.stop();var t=u.replace(".js",".json"),e=fs.createWriteStream(o+"/"+t);e.write(JSON.stringify(r,null,2)),e.end()})}function screenshot(t,e){var s=(t.parent.title+" "+t.title).replace(/\W+/g,"_")+".png",r=""+e+"/"+s;return browser.takeScreenshot().then(function(t){var e=fs.createWriteStream(r);e.write(new Buffer(t,"base64")),e.end()}),r}function splitPath(t,e,s){var r=s+t.split(e)[1],i=r.split("/"),n=i.pop(),a=i.join("/");return[a,n]}var _interopRequire=function(t){return t&&t.__esModule?t["default"]:t},_slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var s,r=[],i=t[Symbol.iterator]();!(s=i.next()).done&&(r.push(s.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},fs=require("fs-extra"),util=require("./util"),specReporter=require("../node_modules/mocha/lib/reporters/spec"),Suite=_interopRequire(require("./classes/suite")),Test=_interopRequire(require("./classes/test")),defaults={screenshotDir:"test/screenshot",outputDir:"test/output",storyDir:"test/stories"};module.exports=Spec,exports.screenshot=screenshot,exports.splitPath=splitPath,Object.defineProperty(exports,"__esModule",{value:!0});var fs=require("fs-extra"),_createClass=function(){function t(t,e){for(var s in e){var r=e[s];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,s,r){return s&&t(e.prototype,s),r&&t(e,r),e}}(),_classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Stats=function(){function t(){var e=void 0===arguments[0]?0:arguments[0],s=void 0===arguments[1]?0:arguments[1],r=void 0===arguments[2]?0:arguments[2],i=void 0===arguments[3]?0:arguments[3];_classCallCheck(this,t),this.tests=e,this.pending=s,this.failures=r,this.duration=i,this.timeStart=null,this.timeStop=null}return _createClass(t,{add:{value:function(t){this.tests+=t.tests,this.pending+=t.pending,this.failures+=t.failures}}}),t}();module.exports=Stats;var _interopRequire=function(t){return t&&t.__esModule?t["default"]:t},_createClass=function(){function t(t,e){for(var s in e){var r=e[s];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,s,r){return s&&t(e.prototype,s),r&&t(e,r),e}}(),_classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Stats=_interopRequire(require("./stats")),Test=_interopRequire(require("./test")),Suite=function(){function t(e,s){_classCallCheck(this,t),this.title=e.title,this.suites=[],this.tests=[],this.parent=s,this.stats=new Stats}return _createClass(t,{addStats:{value:function(t){this.stats.add(t)}},addSuite:{value:function(t){return t.hasTests()?(this.suites.push(t),void this.addStats(t.stats)):!1}},addTest:{value:function(t){this.tests.push(t),this.stats.tests++,t.status===Test.TEST_PENDING?this.stats.pending++:t.status===Test.TEST_FAIL&&this.stats.failures++}},hasTests:{value:function(){return this.tests.length>0}},start:{value:function(){this.stats.timeStart=Date.now()}},stop:{value:function(){return!this.stats.timeStart>0?!1:(this.stats.timeStop=Date.now(),void(this.stats.duration=Math.round((this.stats.timeStop-this.stats.timeStart)/10)/100))}},toJSON:{value:function(){var t=Object.assign({},this);return t.parent=void 0,t}}}),t}();module.exports=Suite;var _classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Test=function t(e,s,r){var i=this;_classCallCheck(this,t),this.status=s,this.title=e.title,this.fullTitle=e.fullTitle(),this.duration=Math.round(e.duration/10)/100,this.error=null,r&&(this.error={},Object.getOwnPropertyNames(r).forEach(function(t){i.error[t]=r[t]}))};Test.TEST_PENDING=2,Test.TEST_PASS=1,Test.TEST_FAIL=0,module.exports=Test;