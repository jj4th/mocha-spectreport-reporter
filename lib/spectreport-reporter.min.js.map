{"version":3,"sources":["spectreport-reporter.min.js"],"names":[],"mappings":"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","file":"spectreport-reporter.min.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(require('clsses/test')) :\n    typeof define === 'function' && define.amd ? define(['clsses/test'], factory) :\n    factory(global.clsses_test)\n}(this, function (clsses_test) { 'use strict';\n\n    class Stats {\n        constructor(tests = 0, pending = 0, failures = 0, duration = 0) {\n            this.tests = tests;\n            this.pending = pending;\n            this.failures = failures;\n            this.duration = duration;\n            this.timeStart = null;\n            this.timeStop = null;\n        }\n        add(stats) {\n            this.tests += stats.tests;\n            this.pending += stats.pending;\n            this.failures += stats.failures;\n        }\n        start() {\n            this.timeStart = Date.now();\n        }\n        stop () {\n            this.timeStop = Date.now();\n            this.duration = Math.round((this.timeStop - this.timeStart) / 10) / 100;\n        }\n    }\n\n    var classes_stats = Stats;\n\n    class Test {\n        constructor(test, status) {\n            this.status = status;\n            this.title = test.title;\n            this.fullTitle = test.fullTitle();\n            this.duration = test.duration;\n\n            // Make sure we only keep error properties\n            Object.getOwnPropertyNames(test.err).forEach(key => {\n                this.error[key] = test.err[key];\n            });\n        };\n    }\n\n    Test.TEST_PENDING = 2;\n    Test.TEST_PASS = 1;\n    Test.TEST_FAIL = 0;\n\n    var classes_test = Test;\n\n    class Suite {\n        constructor(suite, parent) {\n            this.suites = [];\n            this.tests = [];\n            this.parent = parent;\n            this.stats = new classes_stats();\n        }\n        addStats(stats) {\n            this.stats.add(stats);\n        }\n        addSuite(suite) {\n            if (!suite.hasTests()) {\n                return false;\n            }\n            this.suites.push(suite);\n            this.addStats(suite.stats);\n        }\n        addTest(test) {\n            this.tests.push(test);\n            if (test.status === classes_test.TEST_PENDING) {\n                this.stats.pending++;\n            }\n            else if (test.status === classes_test.TEST_PASS) {\n                this.stats.passes++;\n            }\n            else if (test.status === classes_test.TEST_FAIL) {\n                this.stats.failures++;\n            }\n        }\n        hasTests() {\n            return (this.tests.length > 1);\n        }\n        start() {\n            this.stats.start();\n        }\n        stop() {\n            this.stats.stop();\n        }\n        toJSON() {\n            var clone = Object.assign({}, this);\n            clone.parent = undefined;\n            return clone;\n        }\n    }\n\n    var classes_suite = Suite;\n\n    /* jshint ignore:start */\n    const fs = require('fs-extra');\n    const util = require('util');\n\n    /**\n     * Module dependencies.\n     */\n\n    const Base = require('./node_modules/mocha/lib/reporters/base');\n    const color = Base.color;\n\n    const defaults = {\n        screenshotDir: 'test/screenshot',\n        outputDir: 'test/results',\n        storyDir: 'test/stories'\n    };\n\n    /**\n     * Initialize a new `Spec` test reporter.\n     *\n     * @param {Runner} runner\n     * @api public\n     */\n    function Spec(runner, options) {\n        const opts = options.reporterOptions || {};\n        Base.call(this, runner);\n\n        // Handle options and setup defaults\n        opts.screenshotDir = opts.screenshotDir || defaults.screenshotDir;\n        opts.outputDir = opts.outputDir || defaults.outputDir;\n        opts.storyDir = opts.storyDir || defaults.storyDir;\n\n        const self = this;\n        let indents = 0;\n        let curSuite = null;\n\n        const storyPath = runner.suite.suites[0].file;\n\n        const [outputPath, outputFilename] = util.splitPath(storyPath, opts.storyDir, opts.outputDir);\n\n        function indent() {\n            return Array(indents).join('  ');\n        }\n\n        // Handle console output if requested\n        if (opts.console) {\n            let failures = 0;\n            runner.on('start', () => {\n                console.log();\n            });\n\n            runner.on('suite', suite => {\n                ++indents;\n                console.log(color('suite', '%s%s'), indent(), suite.title);\n            });\n\n            runner.on('suite end', () => {\n                --indents;\n                if (indents === 1) {\n                    console.log();\n                }\n            });\n\n            runner.on('pending', test => {\n                let fmt = indent() + color('pending', '  - %s');\n                console.log(fmt, test.title);\n            });\n\n            runner.on('pass', test => {\n                if (test.speed === 'fast') {\n                    let fmt = indent()+ color('checkmark', '  ' + Base.symbols.ok) + color('pass', ' %s ');\n                    console.log(fmt, test.title);\n                } else {\n                    // jshint maxlen:150\n                    let fmt = indent() + color('checkmark', '  ' + Base.symbols.ok) + color('pass', ' %s ') + color(test.speed, '(%dms)');\n                    console.log(fmt, test.title, test.duration);\n                }\n            });\n\n            runner.on('fail', test => {\n                console.log(indent() + color('fail', '  %d) %s'), ++failures, test.title);\n            });\n\n            runner.on('end', self.epilogue.bind(self));\n        }\n\n        // Take screenshots of failed tests if requested\n        if (opts.screenshot) {\n            runner.on('end', () => {\n                util.screenshot(test, opts.screenshotDir);\n            });\n        }\n\n        // Handle JSON output\n\n        runner.on('suite', suite => {\n            curSuite = new classes_suite(suite, curSuite);\n            curSuite.start();\n        });\n\n        runner.on('suite end', () => {\n            curSuite.end();\n\n            if (curSuite.parent) {\n                curSuite.parent.addSuite(curSuite);\n                curSuite = curSuite.parent;\n            }\n        });\n\n        runner.on('pending', test => {\n            curSuite.addTest(new clsses_test(test, clsses_test.TEST_PENDING));\n        });\n\n        runner.on('pass', test => {\n            curSuite.addTest(new clsses_test(test, clsses_test.TEST_PASS));\n        });\n\n        runner.on('fail', test => {\n            curSuite.addTest(new clsses_test(test, clsses_test.TEST_FAIL));\n        });\n\n        runner.on('end', function(){\n            curSuite.end(); // End the current suite again.\n\n            let jsonFilename = outputFilename.replace('.js', '.json');\n            fs.mkdirs(outputPath, function(err) {\n                if (err) {\n                    return console.error(err);\n                }\n\n                let stream = fs.createWriteStream(outputFilename + '/' + jsonFilename);\n                stream.write(JSON.stringify(curSuite, null, 2));\n                stream.end();\n            });\n        });\n    }\n\n    exports = module.exports = Spec;\n    /* jshint ignore:end */\n\n}));\n"],"sourceRoot":"/source/"}